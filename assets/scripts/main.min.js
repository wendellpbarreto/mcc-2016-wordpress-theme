var engineCarousel = function(){
	var carousel = $('#carousel');

	carousel.owlCarousel({
		items: 1,
		lazyLoad: true,
		autoplay: true,
		loop: true,
		animateOut: 'fadeOut',
		animateIn: 'fadeIn',
		dots: true,
	});



	var featuredPostsCarousel = $('#posts .posts__featured-carousel');

	featuredPostsCarousel.owlCarousel({
		items: 1,
		lazyLoad: true,
		autoplay: false,
		loop: true,
		animateOut: 'fadeOut',
		animateIn: 'fadeIn',
		dots: true,
	});

	var $sync1 = $(".post__carousel"),
	$sync2 = $(".post__carousel-thumbs"),
	flag = false,
	duration = 300;

	$sync1
	.owlCarousel({
		items: 1,
		lazyLoad: true,
		margin: 10,
	})
	.on('changed.owl.carousel', function (e) {
		if (!flag) {
			flag = true;
			$sync2.trigger('to.owl.carousel', [e.item.index, duration, true]);
			flag = false;
		}
	});

	$sync2
	.owlCarousel({
		margin: 1,
		// loop: true,
		items: 6,
		// center: true,
	})
	.on('click', '.owl-item', function () {
		$sync1.trigger('to.owl.carousel', [$(this).index(), duration, true]);

	})
	.on('changed.owl.carousel', function (e) {
		if (!flag) {
			flag = true;
			$sync1.trigger('to.owl.carousel', [e.item.index, duration, true]);
			flag = false;
		}
	});

	var wpCarousel = $('.gallery');

	wpCarousel.find('br').remove();
	wpCarousel.find('.gallery-item').each(function() {
		img = $(this).find('img');
		subtitle = img.attr('alt');
		subtitleHtml = '<p class="gallery-title">' + subtitle + '<p>';

		$(this).append(subtitleHtml);
	});

	wpCarousel.owlCarousel({
		items: 1,
		lazyLoad: true,
		autoplay: true,
		// loop: true,
		animateOut: 'fadeOut',
		animateIn: 'fadeIn',
		// dots: true,
		nav: true,
		navClass: ['owl-prev' , 'owl-next'],
		navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
	});
}

$(document).ready(function(){
	engineCarousel();
});

scrollTo = function(target) {
    $('html, body').animate({ scrollTop: target.offset().top - 85 }, 1000);
};

$(document).foundation();

$(document).on('click', '[data-scroll-to]', function() {
    console.log("Clicked")
    scrollTo($($(this).attr('data-scroll-to')));
});

(function() {
    var clickable = {
        elements: document.querySelectorAll('[data-href]'),

        redirect_to: function(href, target) {
            target = target || "";
            clickable.simulate_anchor(href, target);
        },

        simulate_anchor: function(href, target) {
            var anchor = document.createElement("a");
            anchor.setAttribute('href', href);
            anchor.setAttribute('target', target);
            anchor.click();
        },

        init: function() {
            for (var i = 0; i < this.elements.length; i++) {
                var element = this.elements[i];
                element.style.cursor = 'pointer';
                element.addEventListener('click', function() {
                    clickable.redirect_to(
                        this.getAttribute('data-href'),
                        this.getAttribute('data-target')
                    );
                }, false);
            }
        }
    };

    clickable.init();
})();

;(function(window) {

    'use strict';

    var docElem = window.document.documentElement;

    function getViewportH() {
        var client = docElem['clientHeight'],
            inner = window['innerHeight'];

        if( client < inner )
            return inner;
        else
            return client;
    }

    function scrollY() {
        return window.pageYOffset || docElem.scrollTop;
    }

    // http://stackoverflow.com/a/5598797/989439
    function getOffset( el ) {
        var offsetTop = 0, offsetLeft = 0;
        do {
            if ( !isNaN( el.offsetTop ) ) {
                offsetTop += el.offsetTop;
            }
            if ( !isNaN( el.offsetLeft ) ) {
                offsetLeft += el.offsetLeft;
            }
        } while( el = el.offsetParent )

        return {
            top : offsetTop,
            left : offsetLeft
        }
    }

    function inViewport( el, h ) {
        var elH = el.offsetHeight,
            scrolled = scrollY(),
            viewed = scrolled + getViewportH(),
            elTop = getOffset(el).top,
            elBottom = elTop + elH,
            // if 0, the element is considered in the viewport as soon as it enters.
            // if 1, the element is considered in the viewport only when it's fully inside
            // value in percentage (1 >= h >= 0)
            h = h || 0;

        return (elTop + elH * h) <= viewed && (elBottom) >= scrolled;
    }

    function extend( a, b ) {
        for( var key in b ) {
            if( b.hasOwnProperty( key ) ) {
                a[key] = b[key];
            }
        }
        return a;
    }

    function cbpScroller( el, options ) {
        this.el = el;
        this.options = extend( this.defaults, options );
        this._init();
    }

    function hasClass(element, cls) {
        return (' ' + element.className + ' ').indexOf(' ' + cls + ' ') > -1;
    }

    cbpScroller.prototype = {
        defaults : {
            // The viewportFactor defines how much of the appearing item has to be visible in order to trigger the animation
            // if we'd use a value of 0, this would mean that it would add the animation class as soon as the item is in the viewport.
            // If we were to use the value of 1, the animation would only be triggered when we see all of the item in the viewport (100% of it)
            viewportFactor : 0.2
        },
        _init : function() {
            if( Modernizr.touch ) return;
            this.sections = Array.prototype.slice.call( this.el.querySelectorAll( '.animated' ) );
            this.didScroll = false;

            var self = this;

            var scrollHandler = function() {
                    if( !self.didScroll ) {
                        self.didScroll = true;
                        setTimeout( function() { self._scrollPage(); }, 60 );
                    }
                },
                resizeHandler = function() {
                    function delayed() {
                        self._scrollPage();
                        self.resizeTimeout = null;
                    }
                    if ( self.resizeTimeout ) {
                        clearTimeout( self.resizeTimeout );
                    }
                    self.resizeTimeout = setTimeout( delayed, 200 );
                };

            window.addEventListener( 'scroll', scrollHandler, false );
            window.addEventListener( 'resize', resizeHandler, false );
        },
        _scrollPage : function() {
            var self = this;

            this.sections.forEach( function( el, i ) {
                if( inViewport( el, self.options.viewportFactor ) ) {
                    classie.add( el, 'appeared' );

                    if (hasClass(el, 'fade-in-left')) {
                        classie.add(el, 'fadeInLeft');
                    } else if (hasClass(el, 'fade-in-right')) {
                        classie.add(el, 'fadeInRight');
                    } else if (hasClass(el, 'fade-in-up')) {
                        classie.add(el, 'fadeInUp');
                    } else if (hasClass(el, 'fade-in')) {
                        classie.add(el, 'fadeIn');
                    } else if (hasClass(el, 'fade-in-down')) {
                        classie.add(el, 'fadeInDown');
                    }
                }
            });
            this.didScroll = false;
        }
    }

    // add to global namespace
    window.cbpScroller = cbpScroller;

})(window);

maps = function() {
	var init, render;

	render = function() {
		var map, marker, myOptions, style;
		style = [
		{
			"stylers": [
			{
				"saturation": -100
			}, {
				"gamma": 0.8
			}, {
				"lightness": 4
			}, {
				"visibility": "on"
			}
			]
		}, {
			"featureType": "landscape.natural",
			"stylers": [
			{
				"visibility": "on"
			}, {
				"color": "#5dff00"
			}, {
				"gamma": 4.97
			}, {
				"lightness": -5
			}, {
				"saturation": 100
			}
			]
		}
		];
		myOptions = {
			zoom: 18,
			center: new google.maps.LatLng(-5.803316,-35.20184),
			mapTypeId: google.maps.MapTypeId.ROADMAP,
			styles: style,
			mapTypeControl: false,
			streetViewControl: false,
			scrollwheel: false,
			navigationControl: false,
			scaleControl: false,
			overviewMapControl: false,
			panControl: true,
			zoomControl: true,
			zoomControlOptions: {
				style: google.maps.ZoomControlStyle.LARGE
			}
		};
		if (document.getElementById('map')) {
			map = new google.maps.Map(document.getElementById('map'), myOptions);

			marker1 = new google.maps.Marker({
				position: new google.maps.LatLng(-5.803316,-35.20184),
				map: map,
				icon: ''
			});

			// var infowindow1 = new google.maps.InfoWindow({
			// 	content: '<div id="content" class="map__info">'+
			// 	'<h4 class="map__title">Cinema da Fundaj</h4>'+
			// 	'<div id="bodyContent">'+
			// 	'<p class="map__address"><b>Rua Henrique Dias, 609 - Derby - Recife/PE</b></p>' +
			// 	'</div>'+
			// 	'</div>'
			// });

			// google.maps.event.addListener(marker1, 'mouseover', function() {
			// 	infowindow1.open(map, marker1);
			// });
		}
	};
	init = function() {
		if (document.getElementById('map')) {
			return render();
		}
	};
	return {
		init: init
	};
};

$(document).ready(function(){
	var map = maps();
	map.init();
});

function scrollHandler() {
  var scrollTop = $(window).scrollTop();

  var topbar = $('#topbar');
  var topbarHeight = topbar.outerHeight();

	if (scrollTop > topbarHeight) {
		classie.add(topbar[0], 'fixed-topbar');
	} else {
		classie.remove(topbar[0], 'fixed-topbar');
	}
}

// $(window).scroll(scrollHandler);


//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcm91c2VsLmpzIiwibWFpbi5qcyIsIm1hcC5qcyIsInNjcm9sbC1oYW5kbGUuanMiLCJ0b3BiYXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNqTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDekZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2RBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGVuZ2luZUNhcm91c2VsID0gZnVuY3Rpb24oKXtcblx0dmFyIGNhcm91c2VsID0gJCgnI2Nhcm91c2VsJyk7XG5cblx0Y2Fyb3VzZWwub3dsQ2Fyb3VzZWwoe1xuXHRcdGl0ZW1zOiAxLFxuXHRcdGxhenlMb2FkOiB0cnVlLFxuXHRcdGF1dG9wbGF5OiB0cnVlLFxuXHRcdGxvb3A6IHRydWUsXG5cdFx0YW5pbWF0ZU91dDogJ2ZhZGVPdXQnLFxuXHRcdGFuaW1hdGVJbjogJ2ZhZGVJbicsXG5cdFx0ZG90czogdHJ1ZSxcblx0fSk7XG5cblxuXG5cdHZhciBmZWF0dXJlZFBvc3RzQ2Fyb3VzZWwgPSAkKCcjcG9zdHMgLnBvc3RzX19mZWF0dXJlZC1jYXJvdXNlbCcpO1xuXG5cdGZlYXR1cmVkUG9zdHNDYXJvdXNlbC5vd2xDYXJvdXNlbCh7XG5cdFx0aXRlbXM6IDEsXG5cdFx0bGF6eUxvYWQ6IHRydWUsXG5cdFx0YXV0b3BsYXk6IGZhbHNlLFxuXHRcdGxvb3A6IHRydWUsXG5cdFx0YW5pbWF0ZU91dDogJ2ZhZGVPdXQnLFxuXHRcdGFuaW1hdGVJbjogJ2ZhZGVJbicsXG5cdFx0ZG90czogdHJ1ZSxcblx0fSk7XG5cblx0dmFyICRzeW5jMSA9ICQoXCIucG9zdF9fY2Fyb3VzZWxcIiksXG5cdCRzeW5jMiA9ICQoXCIucG9zdF9fY2Fyb3VzZWwtdGh1bWJzXCIpLFxuXHRmbGFnID0gZmFsc2UsXG5cdGR1cmF0aW9uID0gMzAwO1xuXG5cdCRzeW5jMVxuXHQub3dsQ2Fyb3VzZWwoe1xuXHRcdGl0ZW1zOiAxLFxuXHRcdGxhenlMb2FkOiB0cnVlLFxuXHRcdG1hcmdpbjogMTAsXG5cdH0pXG5cdC5vbignY2hhbmdlZC5vd2wuY2Fyb3VzZWwnLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmICghZmxhZykge1xuXHRcdFx0ZmxhZyA9IHRydWU7XG5cdFx0XHQkc3luYzIudHJpZ2dlcigndG8ub3dsLmNhcm91c2VsJywgW2UuaXRlbS5pbmRleCwgZHVyYXRpb24sIHRydWVdKTtcblx0XHRcdGZsYWcgPSBmYWxzZTtcblx0XHR9XG5cdH0pO1xuXG5cdCRzeW5jMlxuXHQub3dsQ2Fyb3VzZWwoe1xuXHRcdG1hcmdpbjogMSxcblx0XHQvLyBsb29wOiB0cnVlLFxuXHRcdGl0ZW1zOiA2LFxuXHRcdC8vIGNlbnRlcjogdHJ1ZSxcblx0fSlcblx0Lm9uKCdjbGljaycsICcub3dsLWl0ZW0nLCBmdW5jdGlvbiAoKSB7XG5cdFx0JHN5bmMxLnRyaWdnZXIoJ3RvLm93bC5jYXJvdXNlbCcsIFskKHRoaXMpLmluZGV4KCksIGR1cmF0aW9uLCB0cnVlXSk7XG5cblx0fSlcblx0Lm9uKCdjaGFuZ2VkLm93bC5jYXJvdXNlbCcsIGZ1bmN0aW9uIChlKSB7XG5cdFx0aWYgKCFmbGFnKSB7XG5cdFx0XHRmbGFnID0gdHJ1ZTtcblx0XHRcdCRzeW5jMS50cmlnZ2VyKCd0by5vd2wuY2Fyb3VzZWwnLCBbZS5pdGVtLmluZGV4LCBkdXJhdGlvbiwgdHJ1ZV0pO1xuXHRcdFx0ZmxhZyA9IGZhbHNlO1xuXHRcdH1cblx0fSk7XG5cblx0dmFyIHdwQ2Fyb3VzZWwgPSAkKCcuZ2FsbGVyeScpO1xuXG5cdHdwQ2Fyb3VzZWwuZmluZCgnYnInKS5yZW1vdmUoKTtcblx0d3BDYXJvdXNlbC5maW5kKCcuZ2FsbGVyeS1pdGVtJykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRpbWcgPSAkKHRoaXMpLmZpbmQoJ2ltZycpO1xuXHRcdHN1YnRpdGxlID0gaW1nLmF0dHIoJ2FsdCcpO1xuXHRcdHN1YnRpdGxlSHRtbCA9ICc8cCBjbGFzcz1cImdhbGxlcnktdGl0bGVcIj4nICsgc3VidGl0bGUgKyAnPHA+JztcblxuXHRcdCQodGhpcykuYXBwZW5kKHN1YnRpdGxlSHRtbCk7XG5cdH0pO1xuXG5cdHdwQ2Fyb3VzZWwub3dsQ2Fyb3VzZWwoe1xuXHRcdGl0ZW1zOiAxLFxuXHRcdGxhenlMb2FkOiB0cnVlLFxuXHRcdGF1dG9wbGF5OiB0cnVlLFxuXHRcdC8vIGxvb3A6IHRydWUsXG5cdFx0YW5pbWF0ZU91dDogJ2ZhZGVPdXQnLFxuXHRcdGFuaW1hdGVJbjogJ2ZhZGVJbicsXG5cdFx0Ly8gZG90czogdHJ1ZSxcblx0XHRuYXY6IHRydWUsXG5cdFx0bmF2Q2xhc3M6IFsnb3dsLXByZXYnICwgJ293bC1uZXh0J10sXG5cdFx0bmF2VGV4dDogWyc8aSBjbGFzcz1cImZhIGZhLWFuZ2xlLWxlZnRcIj48L2k+JywgJzxpIGNsYXNzPVwiZmEgZmEtYW5nbGUtcmlnaHRcIj48L2k+J10sXG5cdH0pO1xufVxuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xuXHRlbmdpbmVDYXJvdXNlbCgpO1xufSk7XG4iLCJzY3JvbGxUbyA9IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHsgc2Nyb2xsVG9wOiB0YXJnZXQub2Zmc2V0KCkudG9wIC0gODUgfSwgMTAwMCk7XG59O1xuXG4kKGRvY3VtZW50KS5mb3VuZGF0aW9uKCk7XG5cbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1zY3JvbGwtdG9dJywgZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2coXCJDbGlja2VkXCIpXG4gICAgc2Nyb2xsVG8oJCgkKHRoaXMpLmF0dHIoJ2RhdGEtc2Nyb2xsLXRvJykpKTtcbn0pO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNsaWNrYWJsZSA9IHtcbiAgICAgICAgZWxlbWVudHM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWhyZWZdJyksXG5cbiAgICAgICAgcmVkaXJlY3RfdG86IGZ1bmN0aW9uKGhyZWYsIHRhcmdldCkge1xuICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0IHx8IFwiXCI7XG4gICAgICAgICAgICBjbGlja2FibGUuc2ltdWxhdGVfYW5jaG9yKGhyZWYsIHRhcmdldCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2ltdWxhdGVfYW5jaG9yOiBmdW5jdGlvbihocmVmLCB0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBhbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcbiAgICAgICAgICAgIGFuY2hvci5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBocmVmKTtcbiAgICAgICAgICAgIGFuY2hvci5zZXRBdHRyaWJ1dGUoJ3RhcmdldCcsIHRhcmdldCk7XG4gICAgICAgICAgICBhbmNob3IuY2xpY2soKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5lbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50c1tpXTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrYWJsZS5yZWRpcmVjdF90byhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLWhyZWYnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLXRhcmdldCcpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNsaWNrYWJsZS5pbml0KCk7XG59KSgpO1xuXG47KGZ1bmN0aW9uKHdpbmRvdykge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGRvY0VsZW0gPSB3aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgZnVuY3Rpb24gZ2V0Vmlld3BvcnRIKCkge1xuICAgICAgICB2YXIgY2xpZW50ID0gZG9jRWxlbVsnY2xpZW50SGVpZ2h0J10sXG4gICAgICAgICAgICBpbm5lciA9IHdpbmRvd1snaW5uZXJIZWlnaHQnXTtcblxuICAgICAgICBpZiggY2xpZW50IDwgaW5uZXIgKVxuICAgICAgICAgICAgcmV0dXJuIGlubmVyO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gY2xpZW50O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjcm9sbFkoKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxUb3A7XG4gICAgfVxuXG4gICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNTU5ODc5Ny85ODk0MzlcbiAgICBmdW5jdGlvbiBnZXRPZmZzZXQoIGVsICkge1xuICAgICAgICB2YXIgb2Zmc2V0VG9wID0gMCwgb2Zmc2V0TGVmdCA9IDA7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGlmICggIWlzTmFOKCBlbC5vZmZzZXRUb3AgKSApIHtcbiAgICAgICAgICAgICAgICBvZmZzZXRUb3AgKz0gZWwub2Zmc2V0VG9wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCAhaXNOYU4oIGVsLm9mZnNldExlZnQgKSApIHtcbiAgICAgICAgICAgICAgICBvZmZzZXRMZWZ0ICs9IGVsLm9mZnNldExlZnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gd2hpbGUoIGVsID0gZWwub2Zmc2V0UGFyZW50IClcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdG9wIDogb2Zmc2V0VG9wLFxuICAgICAgICAgICAgbGVmdCA6IG9mZnNldExlZnRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluVmlld3BvcnQoIGVsLCBoICkge1xuICAgICAgICB2YXIgZWxIID0gZWwub2Zmc2V0SGVpZ2h0LFxuICAgICAgICAgICAgc2Nyb2xsZWQgPSBzY3JvbGxZKCksXG4gICAgICAgICAgICB2aWV3ZWQgPSBzY3JvbGxlZCArIGdldFZpZXdwb3J0SCgpLFxuICAgICAgICAgICAgZWxUb3AgPSBnZXRPZmZzZXQoZWwpLnRvcCxcbiAgICAgICAgICAgIGVsQm90dG9tID0gZWxUb3AgKyBlbEgsXG4gICAgICAgICAgICAvLyBpZiAwLCB0aGUgZWxlbWVudCBpcyBjb25zaWRlcmVkIGluIHRoZSB2aWV3cG9ydCBhcyBzb29uIGFzIGl0IGVudGVycy5cbiAgICAgICAgICAgIC8vIGlmIDEsIHRoZSBlbGVtZW50IGlzIGNvbnNpZGVyZWQgaW4gdGhlIHZpZXdwb3J0IG9ubHkgd2hlbiBpdCdzIGZ1bGx5IGluc2lkZVxuICAgICAgICAgICAgLy8gdmFsdWUgaW4gcGVyY2VudGFnZSAoMSA+PSBoID49IDApXG4gICAgICAgICAgICBoID0gaCB8fCAwO1xuXG4gICAgICAgIHJldHVybiAoZWxUb3AgKyBlbEggKiBoKSA8PSB2aWV3ZWQgJiYgKGVsQm90dG9tKSA+PSBzY3JvbGxlZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleHRlbmQoIGEsIGIgKSB7XG4gICAgICAgIGZvciggdmFyIGtleSBpbiBiICkge1xuICAgICAgICAgICAgaWYoIGIuaGFzT3duUHJvcGVydHkoIGtleSApICkge1xuICAgICAgICAgICAgICAgIGFba2V5XSA9IGJba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYnBTY3JvbGxlciggZWwsIG9wdGlvbnMgKSB7XG4gICAgICAgIHRoaXMuZWwgPSBlbDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKCB0aGlzLmRlZmF1bHRzLCBvcHRpb25zICk7XG4gICAgICAgIHRoaXMuX2luaXQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoYXNDbGFzcyhlbGVtZW50LCBjbHMpIHtcbiAgICAgICAgcmV0dXJuICgnICcgKyBlbGVtZW50LmNsYXNzTmFtZSArICcgJykuaW5kZXhPZignICcgKyBjbHMgKyAnICcpID4gLTE7XG4gICAgfVxuXG4gICAgY2JwU2Nyb2xsZXIucHJvdG90eXBlID0ge1xuICAgICAgICBkZWZhdWx0cyA6IHtcbiAgICAgICAgICAgIC8vIFRoZSB2aWV3cG9ydEZhY3RvciBkZWZpbmVzIGhvdyBtdWNoIG9mIHRoZSBhcHBlYXJpbmcgaXRlbSBoYXMgdG8gYmUgdmlzaWJsZSBpbiBvcmRlciB0byB0cmlnZ2VyIHRoZSBhbmltYXRpb25cbiAgICAgICAgICAgIC8vIGlmIHdlJ2QgdXNlIGEgdmFsdWUgb2YgMCwgdGhpcyB3b3VsZCBtZWFuIHRoYXQgaXQgd291bGQgYWRkIHRoZSBhbmltYXRpb24gY2xhc3MgYXMgc29vbiBhcyB0aGUgaXRlbSBpcyBpbiB0aGUgdmlld3BvcnQuXG4gICAgICAgICAgICAvLyBJZiB3ZSB3ZXJlIHRvIHVzZSB0aGUgdmFsdWUgb2YgMSwgdGhlIGFuaW1hdGlvbiB3b3VsZCBvbmx5IGJlIHRyaWdnZXJlZCB3aGVuIHdlIHNlZSBhbGwgb2YgdGhlIGl0ZW0gaW4gdGhlIHZpZXdwb3J0ICgxMDAlIG9mIGl0KVxuICAgICAgICAgICAgdmlld3BvcnRGYWN0b3IgOiAwLjJcbiAgICAgICAgfSxcbiAgICAgICAgX2luaXQgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmKCBNb2Rlcm5penIudG91Y2ggKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnNlY3Rpb25zID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoIHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCggJy5hbmltYXRlZCcgKSApO1xuICAgICAgICAgICAgdGhpcy5kaWRTY3JvbGwgPSBmYWxzZTtcblxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgc2Nyb2xsSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiggIXNlbGYuZGlkU2Nyb2xsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kaWRTY3JvbGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7IHNlbGYuX3Njcm9sbFBhZ2UoKTsgfSwgNjAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVzaXplSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWxheWVkKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2Nyb2xsUGFnZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZXNpemVUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIHNlbGYucmVzaXplVGltZW91dCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCggc2VsZi5yZXNpemVUaW1lb3V0ICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZXNpemVUaW1lb3V0ID0gc2V0VGltZW91dCggZGVsYXllZCwgMjAwICk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdzY3JvbGwnLCBzY3JvbGxIYW5kbGVyLCBmYWxzZSApO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdyZXNpemUnLCByZXNpemVIYW5kbGVyLCBmYWxzZSApO1xuICAgICAgICB9LFxuICAgICAgICBfc2Nyb2xsUGFnZSA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzLnNlY3Rpb25zLmZvckVhY2goIGZ1bmN0aW9uKCBlbCwgaSApIHtcbiAgICAgICAgICAgICAgICBpZiggaW5WaWV3cG9ydCggZWwsIHNlbGYub3B0aW9ucy52aWV3cG9ydEZhY3RvciApICkge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc2llLmFkZCggZWwsICdhcHBlYXJlZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3MoZWwsICdmYWRlLWluLWxlZnQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NpZS5hZGQoZWwsICdmYWRlSW5MZWZ0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2xhc3MoZWwsICdmYWRlLWluLXJpZ2h0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzaWUuYWRkKGVsLCAnZmFkZUluUmlnaHQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNDbGFzcyhlbCwgJ2ZhZGUtaW4tdXAnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NpZS5hZGQoZWwsICdmYWRlSW5VcCcpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NsYXNzKGVsLCAnZmFkZS1pbicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2llLmFkZChlbCwgJ2ZhZGVJbicpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NsYXNzKGVsLCAnZmFkZS1pbi1kb3duJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzaWUuYWRkKGVsLCAnZmFkZUluRG93bicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmRpZFNjcm9sbCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gYWRkIHRvIGdsb2JhbCBuYW1lc3BhY2VcbiAgICB3aW5kb3cuY2JwU2Nyb2xsZXIgPSBjYnBTY3JvbGxlcjtcblxufSkod2luZG93KTtcbiIsIm1hcHMgPSBmdW5jdGlvbigpIHtcblx0dmFyIGluaXQsIHJlbmRlcjtcblxuXHRyZW5kZXIgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgbWFwLCBtYXJrZXIsIG15T3B0aW9ucywgc3R5bGU7XG5cdFx0c3R5bGUgPSBbXG5cdFx0e1xuXHRcdFx0XCJzdHlsZXJzXCI6IFtcblx0XHRcdHtcblx0XHRcdFx0XCJzYXR1cmF0aW9uXCI6IC0xMDBcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJnYW1tYVwiOiAwLjhcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJsaWdodG5lc3NcIjogNFxuXHRcdFx0fSwge1xuXHRcdFx0XHRcInZpc2liaWxpdHlcIjogXCJvblwiXG5cdFx0XHR9XG5cdFx0XHRdXG5cdFx0fSwge1xuXHRcdFx0XCJmZWF0dXJlVHlwZVwiOiBcImxhbmRzY2FwZS5uYXR1cmFsXCIsXG5cdFx0XHRcInN0eWxlcnNcIjogW1xuXHRcdFx0e1xuXHRcdFx0XHRcInZpc2liaWxpdHlcIjogXCJvblwiXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiY29sb3JcIjogXCIjNWRmZjAwXCJcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJnYW1tYVwiOiA0Ljk3XG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwibGlnaHRuZXNzXCI6IC01XG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwic2F0dXJhdGlvblwiOiAxMDBcblx0XHRcdH1cblx0XHRcdF1cblx0XHR9XG5cdFx0XTtcblx0XHRteU9wdGlvbnMgPSB7XG5cdFx0XHR6b29tOiAxOCxcblx0XHRcdGNlbnRlcjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZygtNS44MDMzMTYsLTM1LjIwMTg0KSxcblx0XHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsXG5cdFx0XHRzdHlsZXM6IHN0eWxlLFxuXHRcdFx0bWFwVHlwZUNvbnRyb2w6IGZhbHNlLFxuXHRcdFx0c3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuXHRcdFx0c2Nyb2xsd2hlZWw6IGZhbHNlLFxuXHRcdFx0bmF2aWdhdGlvbkNvbnRyb2w6IGZhbHNlLFxuXHRcdFx0c2NhbGVDb250cm9sOiBmYWxzZSxcblx0XHRcdG92ZXJ2aWV3TWFwQ29udHJvbDogZmFsc2UsXG5cdFx0XHRwYW5Db250cm9sOiB0cnVlLFxuXHRcdFx0em9vbUNvbnRyb2w6IHRydWUsXG5cdFx0XHR6b29tQ29udHJvbE9wdGlvbnM6IHtcblx0XHRcdFx0c3R5bGU6IGdvb2dsZS5tYXBzLlpvb21Db250cm9sU3R5bGUuTEFSR0Vcblx0XHRcdH1cblx0XHR9O1xuXHRcdGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJykpIHtcblx0XHRcdG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCBteU9wdGlvbnMpO1xuXG5cdFx0XHRtYXJrZXIxID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG5cdFx0XHRcdHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKC01LjgwMzMxNiwtMzUuMjAxODQpLFxuXHRcdFx0XHRtYXA6IG1hcCxcblx0XHRcdFx0aWNvbjogJydcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyB2YXIgaW5mb3dpbmRvdzEgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG5cdFx0XHQvLyBcdGNvbnRlbnQ6ICc8ZGl2IGlkPVwiY29udGVudFwiIGNsYXNzPVwibWFwX19pbmZvXCI+Jytcblx0XHRcdC8vIFx0JzxoNCBjbGFzcz1cIm1hcF9fdGl0bGVcIj5DaW5lbWEgZGEgRnVuZGFqPC9oND4nK1xuXHRcdFx0Ly8gXHQnPGRpdiBpZD1cImJvZHlDb250ZW50XCI+Jytcblx0XHRcdC8vIFx0JzxwIGNsYXNzPVwibWFwX19hZGRyZXNzXCI+PGI+UnVhIEhlbnJpcXVlIERpYXMsIDYwOSAtIERlcmJ5IC0gUmVjaWZlL1BFPC9iPjwvcD4nICtcblx0XHRcdC8vIFx0JzwvZGl2PicrXG5cdFx0XHQvLyBcdCc8L2Rpdj4nXG5cdFx0XHQvLyB9KTtcblxuXHRcdFx0Ly8gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyMSwgJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gXHRpbmZvd2luZG93MS5vcGVuKG1hcCwgbWFya2VyMSk7XG5cdFx0XHQvLyB9KTtcblx0XHR9XG5cdH07XG5cdGluaXQgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpKSB7XG5cdFx0XHRyZXR1cm4gcmVuZGVyKCk7XG5cdFx0fVxuXHR9O1xuXHRyZXR1cm4ge1xuXHRcdGluaXQ6IGluaXRcblx0fTtcbn07XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG5cdHZhciBtYXAgPSBtYXBzKCk7XG5cdG1hcC5pbml0KCk7XG59KTtcbiIsImZ1bmN0aW9uIHNjcm9sbEhhbmRsZXIoKSB7XG4gIHZhciBzY3JvbGxUb3AgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG5cbiAgdmFyIHRvcGJhciA9ICQoJyN0b3BiYXInKTtcbiAgdmFyIHRvcGJhckhlaWdodCA9IHRvcGJhci5vdXRlckhlaWdodCgpO1xuXG5cdGlmIChzY3JvbGxUb3AgPiB0b3BiYXJIZWlnaHQpIHtcblx0XHRjbGFzc2llLmFkZCh0b3BiYXJbMF0sICdmaXhlZC10b3BiYXInKTtcblx0fSBlbHNlIHtcblx0XHRjbGFzc2llLnJlbW92ZSh0b3BiYXJbMF0sICdmaXhlZC10b3BiYXInKTtcblx0fVxufVxuXG4vLyAkKHdpbmRvdykuc2Nyb2xsKHNjcm9sbEhhbmRsZXIpO1xuIiwiIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9