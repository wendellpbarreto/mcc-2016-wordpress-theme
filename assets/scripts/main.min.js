var engineCarousel = function(){
	var carousel = $('#carousel');

	carousel.owlCarousel({
		items: 1,
		lazyLoad: true,
		autoplay: true,
		loop: true,
		animateOut: 'fadeOut',
		animateIn: 'fadeIn',
		dots: true,
	});

	var featuredPostsCarousel = $('#posts .posts__featured-carousel');

	featuredPostsCarousel.owlCarousel({
		items: 1,
		lazyLoad: true,
		autoplay: false,
		loop: true,
		animateOut: 'fadeOut',
		animateIn: 'fadeIn',
		dots: true,
	});

	var $sync1 = $(".post__carousel"),
	$sync2 = $(".post__carousel-thumbs"),
	flag = false,
	duration = 300;

	$sync1
	.owlCarousel({
		items: 1,
		lazyLoad: true,
		margin: 10,
	})
	.on('changed.owl.carousel', function (e) {
		if (!flag) {
			flag = true;
			$sync2.trigger('to.owl.carousel', [e.item.index, duration, true]);
			flag = false;
		}
	});

	$sync2
	.owlCarousel({
		margin: 1,
		// loop: true,
		items: 6,
		center: true,
  })
	.on('click', '.owl-item', function () {
		$sync1.trigger('to.owl.carousel', [$(this).index(), duration, true]);

	})
	.on('changed.owl.carousel', function (e) {
		if (!flag) {
			flag = true;
			$sync1.trigger('to.owl.carousel', [e.item.index, duration, true]);
			flag = false;
		}
	});

}

$(document).ready(function(){
	engineCarousel();
});

scrollTo = function(target) {
    $('html, body').animate({ scrollTop: target.offset().top - 85 }, 1000);
};

$(document).foundation();

$(document).on('click', '[data-scroll-to]', function() {
    console.log("Clicked")
    scrollTo($($(this).attr('data-scroll-to')));
});

(function() {
    var clickable = {
        elements: document.querySelectorAll('[data-href]'),

        redirect_to: function(href, target) {
            target = target || "";
            clickable.simulate_anchor(href, target);
        },

        simulate_anchor: function(href, target) {
            var anchor = document.createElement("a");
            anchor.setAttribute('href', href);
            anchor.setAttribute('target', target);
            anchor.click();
        },

        init: function() {
            for (var i = 0; i < this.elements.length; i++) {
                var element = this.elements[i];
                element.style.cursor = 'pointer';
                element.addEventListener('click', function() {
                    clickable.redirect_to(
                        this.getAttribute('data-href'),
                        this.getAttribute('data-target')
                    );
                }, false);
            }
        }
    };

    clickable.init();
})();

;(function(window) {

    'use strict';

    var docElem = window.document.documentElement;

    function getViewportH() {
        var client = docElem['clientHeight'],
            inner = window['innerHeight'];

        if( client < inner )
            return inner;
        else
            return client;
    }

    function scrollY() {
        return window.pageYOffset || docElem.scrollTop;
    }

    // http://stackoverflow.com/a/5598797/989439
    function getOffset( el ) {
        var offsetTop = 0, offsetLeft = 0;
        do {
            if ( !isNaN( el.offsetTop ) ) {
                offsetTop += el.offsetTop;
            }
            if ( !isNaN( el.offsetLeft ) ) {
                offsetLeft += el.offsetLeft;
            }
        } while( el = el.offsetParent )

        return {
            top : offsetTop,
            left : offsetLeft
        }
    }

    function inViewport( el, h ) {
        var elH = el.offsetHeight,
            scrolled = scrollY(),
            viewed = scrolled + getViewportH(),
            elTop = getOffset(el).top,
            elBottom = elTop + elH,
            // if 0, the element is considered in the viewport as soon as it enters.
            // if 1, the element is considered in the viewport only when it's fully inside
            // value in percentage (1 >= h >= 0)
            h = h || 0;

        return (elTop + elH * h) <= viewed && (elBottom) >= scrolled;
    }

    function extend( a, b ) {
        for( var key in b ) {
            if( b.hasOwnProperty( key ) ) {
                a[key] = b[key];
            }
        }
        return a;
    }

    function cbpScroller( el, options ) {
        this.el = el;
        this.options = extend( this.defaults, options );
        this._init();
    }

    function hasClass(element, cls) {
        return (' ' + element.className + ' ').indexOf(' ' + cls + ' ') > -1;
    }

    cbpScroller.prototype = {
        defaults : {
            // The viewportFactor defines how much of the appearing item has to be visible in order to trigger the animation
            // if we'd use a value of 0, this would mean that it would add the animation class as soon as the item is in the viewport.
            // If we were to use the value of 1, the animation would only be triggered when we see all of the item in the viewport (100% of it)
            viewportFactor : 0.2
        },
        _init : function() {
            if( Modernizr.touch ) return;
            this.sections = Array.prototype.slice.call( this.el.querySelectorAll( '.animated' ) );
            this.didScroll = false;

            var self = this;

            var scrollHandler = function() {
                    if( !self.didScroll ) {
                        self.didScroll = true;
                        setTimeout( function() { self._scrollPage(); }, 60 );
                    }
                },
                resizeHandler = function() {
                    function delayed() {
                        self._scrollPage();
                        self.resizeTimeout = null;
                    }
                    if ( self.resizeTimeout ) {
                        clearTimeout( self.resizeTimeout );
                    }
                    self.resizeTimeout = setTimeout( delayed, 200 );
                };

            window.addEventListener( 'scroll', scrollHandler, false );
            window.addEventListener( 'resize', resizeHandler, false );
        },
        _scrollPage : function() {
            var self = this;

            this.sections.forEach( function( el, i ) {
                if( inViewport( el, self.options.viewportFactor ) ) {
                    classie.add( el, 'appeared' );

                    if (hasClass(el, 'fade-in-left')) {
                        classie.add(el, 'fadeInLeft');
                    } else if (hasClass(el, 'fade-in-right')) {
                        classie.add(el, 'fadeInRight');
                    } else if (hasClass(el, 'fade-in-up')) {
                        classie.add(el, 'fadeInUp');
                    } else if (hasClass(el, 'fade-in')) {
                        classie.add(el, 'fadeIn');
                    } else if (hasClass(el, 'fade-in-down')) {
                        classie.add(el, 'fadeInDown');
                    }
                }
            });
            this.didScroll = false;
        }
    }

    // add to global namespace
    window.cbpScroller = cbpScroller;

})(window);

maps = function() {
	var init, render;

	render = function() {
		var map, marker, myOptions, style;
		style = [
		{
			"stylers": [
			{
				"saturation": -100
			}, {
				"gamma": 0.8
			}, {
				"lightness": 4
			}, {
				"visibility": "on"
			}
			]
		}, {
			"featureType": "landscape.natural",
			"stylers": [
			{
				"visibility": "on"
			}, {
				"color": "#5dff00"
			}, {
				"gamma": 4.97
			}, {
				"lightness": -5
			}, {
				"saturation": 100
			}
			]
		}
		];
		myOptions = {
			zoom: 18,
			center: new google.maps.LatLng(-5.803316,-35.20184),
			mapTypeId: google.maps.MapTypeId.ROADMAP,
			styles: style,
			mapTypeControl: false,
			streetViewControl: false,
			scrollwheel: false,
			navigationControl: false,
			scaleControl: false,
			overviewMapControl: false,
			panControl: true,
			zoomControl: true,
			zoomControlOptions: {
				style: google.maps.ZoomControlStyle.LARGE
			}
		};
		if (document.getElementById('map')) {
			map = new google.maps.Map(document.getElementById('map'), myOptions);

			marker1 = new google.maps.Marker({
				position: new google.maps.LatLng(-5.803316,-35.20184),
				map: map,
				icon: ''
			});

			// var infowindow1 = new google.maps.InfoWindow({
			// 	content: '<div id="content" class="map__info">'+
			// 	'<h4 class="map__title">Cinema da Fundaj</h4>'+
			// 	'<div id="bodyContent">'+
			// 	'<p class="map__address"><b>Rua Henrique Dias, 609 - Derby - Recife/PE</b></p>' +
			// 	'</div>'+
			// 	'</div>'
			// });

			// google.maps.event.addListener(marker1, 'mouseover', function() {
			// 	infowindow1.open(map, marker1);
			// });
		}
	};
	init = function() {
		if (document.getElementById('map')) {
			return render();
		}
	};
	return {
		init: init
	};
};

$(document).ready(function(){
	var map = maps();
	map.init();
});

function scrollHandler() {
  var scrollTop = $(window).scrollTop();

  var topbar = $('#topbar');
  var topbarHeight = topbar.outerHeight();

	if (scrollTop > topbarHeight) {
		classie.add(topbar[0], 'fixed-topbar');
	} else {
		classie.remove(topbar[0], 'fixed-topbar');
	}
}

// $(window).scroll(scrollHandler);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcm91c2VsLmpzIiwibWFpbi5qcyIsIm1hcC5qcyIsInNjcm9sbC1oYW5kbGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZW5naW5lQ2Fyb3VzZWwgPSBmdW5jdGlvbigpe1xuXHR2YXIgY2Fyb3VzZWwgPSAkKCcjY2Fyb3VzZWwnKTtcblxuXHRjYXJvdXNlbC5vd2xDYXJvdXNlbCh7XG5cdFx0aXRlbXM6IDEsXG5cdFx0bGF6eUxvYWQ6IHRydWUsXG5cdFx0YXV0b3BsYXk6IHRydWUsXG5cdFx0bG9vcDogdHJ1ZSxcblx0XHRhbmltYXRlT3V0OiAnZmFkZU91dCcsXG5cdFx0YW5pbWF0ZUluOiAnZmFkZUluJyxcblx0XHRkb3RzOiB0cnVlLFxuXHR9KTtcblxuXHR2YXIgZmVhdHVyZWRQb3N0c0Nhcm91c2VsID0gJCgnI3Bvc3RzIC5wb3N0c19fZmVhdHVyZWQtY2Fyb3VzZWwnKTtcblxuXHRmZWF0dXJlZFBvc3RzQ2Fyb3VzZWwub3dsQ2Fyb3VzZWwoe1xuXHRcdGl0ZW1zOiAxLFxuXHRcdGxhenlMb2FkOiB0cnVlLFxuXHRcdGF1dG9wbGF5OiBmYWxzZSxcblx0XHRsb29wOiB0cnVlLFxuXHRcdGFuaW1hdGVPdXQ6ICdmYWRlT3V0Jyxcblx0XHRhbmltYXRlSW46ICdmYWRlSW4nLFxuXHRcdGRvdHM6IHRydWUsXG5cdH0pO1xuXG5cdHZhciAkc3luYzEgPSAkKFwiLnBvc3RfX2Nhcm91c2VsXCIpLFxuXHQkc3luYzIgPSAkKFwiLnBvc3RfX2Nhcm91c2VsLXRodW1ic1wiKSxcblx0ZmxhZyA9IGZhbHNlLFxuXHRkdXJhdGlvbiA9IDMwMDtcblxuXHQkc3luYzFcblx0Lm93bENhcm91c2VsKHtcblx0XHRpdGVtczogMSxcblx0XHRsYXp5TG9hZDogdHJ1ZSxcblx0XHRtYXJnaW46IDEwLFxuXHR9KVxuXHQub24oJ2NoYW5nZWQub3dsLmNhcm91c2VsJywgZnVuY3Rpb24gKGUpIHtcblx0XHRpZiAoIWZsYWcpIHtcblx0XHRcdGZsYWcgPSB0cnVlO1xuXHRcdFx0JHN5bmMyLnRyaWdnZXIoJ3RvLm93bC5jYXJvdXNlbCcsIFtlLml0ZW0uaW5kZXgsIGR1cmF0aW9uLCB0cnVlXSk7XG5cdFx0XHRmbGFnID0gZmFsc2U7XG5cdFx0fVxuXHR9KTtcblxuXHQkc3luYzJcblx0Lm93bENhcm91c2VsKHtcblx0XHRtYXJnaW46IDEsXG5cdFx0Ly8gbG9vcDogdHJ1ZSxcblx0XHRpdGVtczogNixcblx0XHRjZW50ZXI6IHRydWUsXG4gIH0pXG5cdC5vbignY2xpY2snLCAnLm93bC1pdGVtJywgZnVuY3Rpb24gKCkge1xuXHRcdCRzeW5jMS50cmlnZ2VyKCd0by5vd2wuY2Fyb3VzZWwnLCBbJCh0aGlzKS5pbmRleCgpLCBkdXJhdGlvbiwgdHJ1ZV0pO1xuXG5cdH0pXG5cdC5vbignY2hhbmdlZC5vd2wuY2Fyb3VzZWwnLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmICghZmxhZykge1xuXHRcdFx0ZmxhZyA9IHRydWU7XG5cdFx0XHQkc3luYzEudHJpZ2dlcigndG8ub3dsLmNhcm91c2VsJywgW2UuaXRlbS5pbmRleCwgZHVyYXRpb24sIHRydWVdKTtcblx0XHRcdGZsYWcgPSBmYWxzZTtcblx0XHR9XG5cdH0pO1xuXG59XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG5cdGVuZ2luZUNhcm91c2VsKCk7XG59KTtcbiIsInNjcm9sbFRvID0gZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoeyBzY3JvbGxUb3A6IHRhcmdldC5vZmZzZXQoKS50b3AgLSA4NSB9LCAxMDAwKTtcbn07XG5cbiQoZG9jdW1lbnQpLmZvdW5kYXRpb24oKTtcblxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJ1tkYXRhLXNjcm9sbC10b10nLCBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZyhcIkNsaWNrZWRcIilcbiAgICBzY3JvbGxUbygkKCQodGhpcykuYXR0cignZGF0YS1zY3JvbGwtdG8nKSkpO1xufSk7XG5cbihmdW5jdGlvbigpIHtcbiAgICB2YXIgY2xpY2thYmxlID0ge1xuICAgICAgICBlbGVtZW50czogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaHJlZl0nKSxcblxuICAgICAgICByZWRpcmVjdF90bzogZnVuY3Rpb24oaHJlZiwgdGFyZ2V0KSB7XG4gICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQgfHwgXCJcIjtcbiAgICAgICAgICAgIGNsaWNrYWJsZS5zaW11bGF0ZV9hbmNob3IoaHJlZiwgdGFyZ2V0KTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaW11bGF0ZV9hbmNob3I6IGZ1bmN0aW9uKGhyZWYsIHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIGFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgICAgICAgICAgYW5jaG9yLnNldEF0dHJpYnV0ZSgnaHJlZicsIGhyZWYpO1xuICAgICAgICAgICAgYW5jaG9yLnNldEF0dHJpYnV0ZSgndGFyZ2V0JywgdGFyZ2V0KTtcbiAgICAgICAgICAgIGFuY2hvci5jbGljaygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2thYmxlLnJlZGlyZWN0X3RvKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtaHJlZicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0JylcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY2xpY2thYmxlLmluaXQoKTtcbn0pKCk7XG5cbjsoZnVuY3Rpb24od2luZG93KSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgZG9jRWxlbSA9IHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cbiAgICBmdW5jdGlvbiBnZXRWaWV3cG9ydEgoKSB7XG4gICAgICAgIHZhciBjbGllbnQgPSBkb2NFbGVtWydjbGllbnRIZWlnaHQnXSxcbiAgICAgICAgICAgIGlubmVyID0gd2luZG93Wydpbm5lckhlaWdodCddO1xuXG4gICAgICAgIGlmKCBjbGllbnQgPCBpbm5lciApXG4gICAgICAgICAgICByZXR1cm4gaW5uZXI7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBjbGllbnQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2Nyb2xsWSgpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbFRvcDtcbiAgICB9XG5cbiAgICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS81NTk4Nzk3Lzk4OTQzOVxuICAgIGZ1bmN0aW9uIGdldE9mZnNldCggZWwgKSB7XG4gICAgICAgIHZhciBvZmZzZXRUb3AgPSAwLCBvZmZzZXRMZWZ0ID0gMDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgaWYgKCAhaXNOYU4oIGVsLm9mZnNldFRvcCApICkge1xuICAgICAgICAgICAgICAgIG9mZnNldFRvcCArPSBlbC5vZmZzZXRUb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoICFpc05hTiggZWwub2Zmc2V0TGVmdCApICkge1xuICAgICAgICAgICAgICAgIG9mZnNldExlZnQgKz0gZWwub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSB3aGlsZSggZWwgPSBlbC5vZmZzZXRQYXJlbnQgKVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0b3AgOiBvZmZzZXRUb3AsXG4gICAgICAgICAgICBsZWZ0IDogb2Zmc2V0TGVmdFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5WaWV3cG9ydCggZWwsIGggKSB7XG4gICAgICAgIHZhciBlbEggPSBlbC5vZmZzZXRIZWlnaHQsXG4gICAgICAgICAgICBzY3JvbGxlZCA9IHNjcm9sbFkoKSxcbiAgICAgICAgICAgIHZpZXdlZCA9IHNjcm9sbGVkICsgZ2V0Vmlld3BvcnRIKCksXG4gICAgICAgICAgICBlbFRvcCA9IGdldE9mZnNldChlbCkudG9wLFxuICAgICAgICAgICAgZWxCb3R0b20gPSBlbFRvcCArIGVsSCxcbiAgICAgICAgICAgIC8vIGlmIDAsIHRoZSBlbGVtZW50IGlzIGNvbnNpZGVyZWQgaW4gdGhlIHZpZXdwb3J0IGFzIHNvb24gYXMgaXQgZW50ZXJzLlxuICAgICAgICAgICAgLy8gaWYgMSwgdGhlIGVsZW1lbnQgaXMgY29uc2lkZXJlZCBpbiB0aGUgdmlld3BvcnQgb25seSB3aGVuIGl0J3MgZnVsbHkgaW5zaWRlXG4gICAgICAgICAgICAvLyB2YWx1ZSBpbiBwZXJjZW50YWdlICgxID49IGggPj0gMClcbiAgICAgICAgICAgIGggPSBoIHx8IDA7XG5cbiAgICAgICAgcmV0dXJuIChlbFRvcCArIGVsSCAqIGgpIDw9IHZpZXdlZCAmJiAoZWxCb3R0b20pID49IHNjcm9sbGVkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGV4dGVuZCggYSwgYiApIHtcbiAgICAgICAgZm9yKCB2YXIga2V5IGluIGIgKSB7XG4gICAgICAgICAgICBpZiggYi5oYXNPd25Qcm9wZXJ0eSgga2V5ICkgKSB7XG4gICAgICAgICAgICAgICAgYVtrZXldID0gYltrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNicFNjcm9sbGVyKCBlbCwgb3B0aW9ucyApIHtcbiAgICAgICAgdGhpcy5lbCA9IGVsO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBleHRlbmQoIHRoaXMuZGVmYXVsdHMsIG9wdGlvbnMgKTtcbiAgICAgICAgdGhpcy5faW5pdCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhc0NsYXNzKGVsZW1lbnQsIGNscykge1xuICAgICAgICByZXR1cm4gKCcgJyArIGVsZW1lbnQuY2xhc3NOYW1lICsgJyAnKS5pbmRleE9mKCcgJyArIGNscyArICcgJykgPiAtMTtcbiAgICB9XG5cbiAgICBjYnBTY3JvbGxlci5wcm90b3R5cGUgPSB7XG4gICAgICAgIGRlZmF1bHRzIDoge1xuICAgICAgICAgICAgLy8gVGhlIHZpZXdwb3J0RmFjdG9yIGRlZmluZXMgaG93IG11Y2ggb2YgdGhlIGFwcGVhcmluZyBpdGVtIGhhcyB0byBiZSB2aXNpYmxlIGluIG9yZGVyIHRvIHRyaWdnZXIgdGhlIGFuaW1hdGlvblxuICAgICAgICAgICAgLy8gaWYgd2UnZCB1c2UgYSB2YWx1ZSBvZiAwLCB0aGlzIHdvdWxkIG1lYW4gdGhhdCBpdCB3b3VsZCBhZGQgdGhlIGFuaW1hdGlvbiBjbGFzcyBhcyBzb29uIGFzIHRoZSBpdGVtIGlzIGluIHRoZSB2aWV3cG9ydC5cbiAgICAgICAgICAgIC8vIElmIHdlIHdlcmUgdG8gdXNlIHRoZSB2YWx1ZSBvZiAxLCB0aGUgYW5pbWF0aW9uIHdvdWxkIG9ubHkgYmUgdHJpZ2dlcmVkIHdoZW4gd2Ugc2VlIGFsbCBvZiB0aGUgaXRlbSBpbiB0aGUgdmlld3BvcnQgKDEwMCUgb2YgaXQpXG4gICAgICAgICAgICB2aWV3cG9ydEZhY3RvciA6IDAuMlxuICAgICAgICB9LFxuICAgICAgICBfaW5pdCA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYoIE1vZGVybml6ci50b3VjaCApIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMuc2VjdGlvbnMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCggdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKCAnLmFuaW1hdGVkJyApICk7XG4gICAgICAgICAgICB0aGlzLmRpZFNjcm9sbCA9IGZhbHNlO1xuXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBzY3JvbGxIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKCAhc2VsZi5kaWRTY3JvbGwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRpZFNjcm9sbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsgc2VsZi5fc2Nyb2xsUGFnZSgpOyB9LCA2MCApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXNpemVIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGF5ZWQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zY3JvbGxQYWdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlc2l6ZVRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICggc2VsZi5yZXNpemVUaW1lb3V0ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCBzZWxmLnJlc2l6ZVRpbWVvdXQgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxmLnJlc2l6ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCBkZWxheWVkLCAyMDAgKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Njcm9sbCcsIHNjcm9sbEhhbmRsZXIsIGZhbHNlICk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIHJlc2l6ZUhhbmRsZXIsIGZhbHNlICk7XG4gICAgICAgIH0sXG4gICAgICAgIF9zY3JvbGxQYWdlIDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuc2VjdGlvbnMuZm9yRWFjaCggZnVuY3Rpb24oIGVsLCBpICkge1xuICAgICAgICAgICAgICAgIGlmKCBpblZpZXdwb3J0KCBlbCwgc2VsZi5vcHRpb25zLnZpZXdwb3J0RmFjdG9yICkgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzaWUuYWRkKCBlbCwgJ2FwcGVhcmVkJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNDbGFzcyhlbCwgJ2ZhZGUtaW4tbGVmdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2llLmFkZChlbCwgJ2ZhZGVJbkxlZnQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNDbGFzcyhlbCwgJ2ZhZGUtaW4tcmlnaHQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NpZS5hZGQoZWwsICdmYWRlSW5SaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NsYXNzKGVsLCAnZmFkZS1pbi11cCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2llLmFkZChlbCwgJ2ZhZGVJblVwJyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2xhc3MoZWwsICdmYWRlLWluJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzaWUuYWRkKGVsLCAnZmFkZUluJyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2xhc3MoZWwsICdmYWRlLWluLWRvd24nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NpZS5hZGQoZWwsICdmYWRlSW5Eb3duJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZGlkU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBhZGQgdG8gZ2xvYmFsIG5hbWVzcGFjZVxuICAgIHdpbmRvdy5jYnBTY3JvbGxlciA9IGNicFNjcm9sbGVyO1xuXG59KSh3aW5kb3cpO1xuIiwibWFwcyA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgaW5pdCwgcmVuZGVyO1xuXG5cdHJlbmRlciA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBtYXAsIG1hcmtlciwgbXlPcHRpb25zLCBzdHlsZTtcblx0XHRzdHlsZSA9IFtcblx0XHR7XG5cdFx0XHRcInN0eWxlcnNcIjogW1xuXHRcdFx0e1xuXHRcdFx0XHRcInNhdHVyYXRpb25cIjogLTEwMFxuXHRcdFx0fSwge1xuXHRcdFx0XHRcImdhbW1hXCI6IDAuOFxuXHRcdFx0fSwge1xuXHRcdFx0XHRcImxpZ2h0bmVzc1wiOiA0XG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwidmlzaWJpbGl0eVwiOiBcIm9uXCJcblx0XHRcdH1cblx0XHRcdF1cblx0XHR9LCB7XG5cdFx0XHRcImZlYXR1cmVUeXBlXCI6IFwibGFuZHNjYXBlLm5hdHVyYWxcIixcblx0XHRcdFwic3R5bGVyc1wiOiBbXG5cdFx0XHR7XG5cdFx0XHRcdFwidmlzaWJpbGl0eVwiOiBcIm9uXCJcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJjb2xvclwiOiBcIiM1ZGZmMDBcIlxuXHRcdFx0fSwge1xuXHRcdFx0XHRcImdhbW1hXCI6IDQuOTdcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJsaWdodG5lc3NcIjogLTVcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJzYXR1cmF0aW9uXCI6IDEwMFxuXHRcdFx0fVxuXHRcdFx0XVxuXHRcdH1cblx0XHRdO1xuXHRcdG15T3B0aW9ucyA9IHtcblx0XHRcdHpvb206IDE4LFxuXHRcdFx0Y2VudGVyOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKC01LjgwMzMxNiwtMzUuMjAxODQpLFxuXHRcdFx0bWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcblx0XHRcdHN0eWxlczogc3R5bGUsXG5cdFx0XHRtYXBUeXBlQ29udHJvbDogZmFsc2UsXG5cdFx0XHRzdHJlZXRWaWV3Q29udHJvbDogZmFsc2UsXG5cdFx0XHRzY3JvbGx3aGVlbDogZmFsc2UsXG5cdFx0XHRuYXZpZ2F0aW9uQ29udHJvbDogZmFsc2UsXG5cdFx0XHRzY2FsZUNvbnRyb2w6IGZhbHNlLFxuXHRcdFx0b3ZlcnZpZXdNYXBDb250cm9sOiBmYWxzZSxcblx0XHRcdHBhbkNvbnRyb2w6IHRydWUsXG5cdFx0XHR6b29tQ29udHJvbDogdHJ1ZSxcblx0XHRcdHpvb21Db250cm9sT3B0aW9uczoge1xuXHRcdFx0XHRzdHlsZTogZ29vZ2xlLm1hcHMuWm9vbUNvbnRyb2xTdHlsZS5MQVJHRVxuXHRcdFx0fVxuXHRcdH07XG5cdFx0aWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSkge1xuXHRcdFx0bWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIG15T3B0aW9ucyk7XG5cblx0XHRcdG1hcmtlcjEgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcblx0XHRcdFx0cG9zaXRpb246IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoLTUuODAzMzE2LC0zNS4yMDE4NCksXG5cdFx0XHRcdG1hcDogbWFwLFxuXHRcdFx0XHRpY29uOiAnJ1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIHZhciBpbmZvd2luZG93MSA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KHtcblx0XHRcdC8vIFx0Y29udGVudDogJzxkaXYgaWQ9XCJjb250ZW50XCIgY2xhc3M9XCJtYXBfX2luZm9cIj4nK1xuXHRcdFx0Ly8gXHQnPGg0IGNsYXNzPVwibWFwX190aXRsZVwiPkNpbmVtYSBkYSBGdW5kYWo8L2g0PicrXG5cdFx0XHQvLyBcdCc8ZGl2IGlkPVwiYm9keUNvbnRlbnRcIj4nK1xuXHRcdFx0Ly8gXHQnPHAgY2xhc3M9XCJtYXBfX2FkZHJlc3NcIj48Yj5SdWEgSGVucmlxdWUgRGlhcywgNjA5IC0gRGVyYnkgLSBSZWNpZmUvUEU8L2I+PC9wPicgK1xuXHRcdFx0Ly8gXHQnPC9kaXY+Jytcblx0XHRcdC8vIFx0JzwvZGl2Pidcblx0XHRcdC8vIH0pO1xuXG5cdFx0XHQvLyBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIxLCAnbW91c2VvdmVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBcdGluZm93aW5kb3cxLm9wZW4obWFwLCBtYXJrZXIxKTtcblx0XHRcdC8vIH0pO1xuXHRcdH1cblx0fTtcblx0aW5pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJykpIHtcblx0XHRcdHJldHVybiByZW5kZXIoKTtcblx0XHR9XG5cdH07XG5cdHJldHVybiB7XG5cdFx0aW5pdDogaW5pdFxuXHR9O1xufTtcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcblx0dmFyIG1hcCA9IG1hcHMoKTtcblx0bWFwLmluaXQoKTtcbn0pO1xuIiwiZnVuY3Rpb24gc2Nyb2xsSGFuZGxlcigpIHtcbiAgdmFyIHNjcm9sbFRvcCA9ICQod2luZG93KS5zY3JvbGxUb3AoKTtcblxuICB2YXIgdG9wYmFyID0gJCgnI3RvcGJhcicpO1xuICB2YXIgdG9wYmFySGVpZ2h0ID0gdG9wYmFyLm91dGVySGVpZ2h0KCk7XG5cblx0aWYgKHNjcm9sbFRvcCA+IHRvcGJhckhlaWdodCkge1xuXHRcdGNsYXNzaWUuYWRkKHRvcGJhclswXSwgJ2ZpeGVkLXRvcGJhcicpO1xuXHR9IGVsc2Uge1xuXHRcdGNsYXNzaWUucmVtb3ZlKHRvcGJhclswXSwgJ2ZpeGVkLXRvcGJhcicpO1xuXHR9XG59XG5cbi8vICQod2luZG93KS5zY3JvbGwoc2Nyb2xsSGFuZGxlcik7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=